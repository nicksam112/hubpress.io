<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>Natural Evolution Strategies in Keras</title>
    <meta name="description" content="" />
    <link href="//fonts.googleapis.com/css?family=Noto+Sans:300,400,700" rel="stylesheet" type="text/css">
    <link href="//fonts.googleapis.com/css?family=Noto+Serif:400,700,400italic" rel="stylesheet" type="text/css">
    <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
    <link href="//nicksam112.github.io/themes/saga/assets/css/style.css?v=1502307335087" rel="stylesheet" type="text/css">
    <link href="//nicksam112.github.io/themes/saga/assets/css/animate.min.css?v=1502307335087" rel="stylesheet" type="text/css">
    <link href="https://nicksam112.github.io/favicon.ico" rel="shortcut icon">
    <link rel="canonical" href="https://nicksam112.github.io/2017/08/02/Natural-Evolution-Strategies-in-Keras.html" />
    <meta name="referrer" content="origin" />
    
    <meta property="og:site_name" content="Nick Samoray&#x27;s Blog" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Natural Evolution Strategies in Keras" />
    <meta property="og:description" content="This blog post is written to serve as background and explaination for my implementation of Natural Evolution Strategies in Keras Background If you&amp;#8217;re familiar with neural networks, you&amp;#8217;ve probably run into the concept of backpropagation. It&amp;#8217;s the most common method of training neural networks" />
    <meta property="og:url" content="https://nicksam112.github.io/2017/08/02/Natural-Evolution-Strategies-in-Keras.html" />
    <meta property="og:image" content="http://az616578.vo.msecnd.net/files/2016/09/26/636104905812273029522410039_evolution-005.jpg" />
    <meta property="article:published_time" content="2017-08-02T00:00:00.000Z" />
    <meta property="article:tag" content="Keras" />
    <meta property="article:tag" content="Neural Networks" />
    <meta property="article:tag" content="Evolution Strategies" />
    
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Natural Evolution Strategies in Keras" />
    <meta name="twitter:description" content="This blog post is written to serve as background and explaination for my implementation of Natural Evolution Strategies in Keras Background If you&amp;#8217;re familiar with neural networks, you&amp;#8217;ve probably run into the concept of backpropagation. It&amp;#8217;s the most common method of training neural networks" />
    <meta name="twitter:url" content="https://nicksam112.github.io/2017/08/02/Natural-Evolution-Strategies-in-Keras.html" />
    <meta name="twitter:image:src" content="http://az616578.vo.msecnd.net/files/2016/09/26/636104905812273029522410039_evolution-005.jpg" />
    
    <script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "Article",
    "publisher": "Nick Samoray's Blog",
    "author": {
        "@type": "Person",
        "name": "Nick Samoray",
        "image": "https://avatars3.githubusercontent.com/u/11080378?v=4",
        "url": "https://nicksam112.github.io/author/nicksam112/",
        "description": "I don&#x27;t put much here besides the occasional bad idea"
    },
    "headline": "Natural Evolution Strategies in Keras",
    "url": "https://nicksam112.github.io/2017/08/02/Natural-Evolution-Strategies-in-Keras.html",
    "datePublished": "2017-08-02T00:00:00.000Z",
    "image": "http://az616578.vo.msecnd.net/files/2016/09/26/636104905812273029522410039_evolution-005.jpg",
    "keywords": "Keras, Neural Networks, Evolution Strategies",
    "description": "This blog post is written to serve as background and explaination for my implementation of Natural Evolution Strategies in Keras Background If you&amp;#8217;re familiar with neural networks, you&amp;#8217;ve probably run into the concept of backpropagation. It&amp;#8217;s the most common method of training neural networks"
}
    </script>

    <meta name="generator" content="HubPress" />
    <link rel="alternate" type="application/rss+xml" title="Nick Samoray&#x27;s Blog" href="https://nicksam112.github.io/rss/" />
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.10.0/styles/atom-one-dark.min.css">
</head>
<body class="post-template tag-Keras tag-Neural-Networks tag-Evolution-Strategies">
    <header id="header" class="animated fadeIn" style="background-image: url(http://az616578.vo.msecnd.net/files/2016/09/26/636104905812273029522410039_evolution-005.jpg)">
    <div class="header-background">
    <section class="blog-content">
        <a id="site-url" class="blog-title" href="https://nicksam112.github.io">Nick Samoray&#x27;s Blog</a>
        <span class="blog-description">Posts and Projects</span>
        <nav class="links fadeIn animated">
            <ul>
                <li class="rss"><a title="RSS Feed" href="/rss/"><i class="fa fa-fw fa-rss-square"></i></a></li>
        
            </ul>
        </nav>
    </section>
    <section class="header-content">
        <h1 class="post-title animated fadeInUp">Natural Evolution Strategies in Keras</h1>
        <span class="post-data"><span class="date animated fadeInUp"><i class="fa fa-clock-o"></i> <time class="timesince date" data-timesince="1501650000" datetime="2017-08-02T00:00" title="02 August 2017">8 days ago</time></span>
            <span class="tags animated fadeInUp"><i class="fa fa-tags"></i> <a href="https://nicksam112.github.io/tag/Keras/">Keras</a>, <a href="https://nicksam112.github.io/tag/Neural-Networks/">Neural Networks</a>, <a href="https://nicksam112.github.io/tag/Evolution-Strategies/">Evolution Strategies</a></span>
            <span class="author animated fadeInUp"><i class="fa fa-user"></i> <a href="https://nicksam112.github.io/author/nicksam112/">Nick Samoray</a></span></span>
    </section>
    </div>
</header>
<main id="main" class="content">
    <article itemtype="http://schema.org/BlogPosting" class="animated fadeIn content post post tag-Keras tag-Neural-Networks tag-Evolution-Strategies">
        <section class="post-content">
            <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This blog post is written to serve as background and explaination for my implementation of <a href="https://gist.github.com/nicksam112/00e9638c0efad1adac878522cf172484">Natural Evolution Strategies in Keras</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_background">Background</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you&#8217;re familiar with neural networks, you&#8217;ve probably run into the concept of backpropagation. It&#8217;s the most common method of training neural networks and for good reason, it&#8217;s extremely effective for complex tasks such as image recognition.</p>
</div>
<div class="paragraph">
<p>But for tasks such as reinforcement learning there may be other feasible methods, at least that&#8217;s what OpenAI is saying in their <a href="https://blog.openai.com/evolution-strategies/">recent blog post</a></p>
</div>
<div class="paragraph">
<p>The gist of it is that while reinforcement learning has seen incredible advances in recent years, with advances such as Deep Q Learning, A3C, and more, it&#8217;s still incredibly difficult to scale. Training typically is done on a single machine due to the communication costs of constantly sharing massive weight files between processes and machines, with asynchronous methods like A3C limited to a single CPU due to these communication costs.</p>
</div>
<div class="paragraph">
<p>That&#8217;s where OpenAI is saying Natural Evolution Strategies come into play, since you only have to share a couple of scalars instead of all the weights, it becomes far easier to scale it up to multiple machines or a cluster.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_what_are_evolution_strategies">What are Evolution Strategies?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Evolution strategies, sometimes known as genetic algorithms, are a broad category that need more than a single blog post to go over, but the basics for this implementation are fairly simple.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a bunch of models with weights randomly generated on a normal distribution</p>
</li>
<li>
<p>Evaluate all the models on the environment you&#8217;re trying to solve</p>
</li>
<li>
<p>Collect all the rewards, and weight the weights (eugh) according to their performance</p>
</li>
<li>
<p>Sum up the weights and update a central model that will serve as the base for the next round of randomly generated weights</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>You can see why they&#8217;re called "Evolution Strategies", at it&#8217;s core you&#8217;re throwing a bunch of models into the environment, picking the best, and repeating.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_use_them">Why Use Them?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As mentioned in the background they&#8217;re easy to scale due to the low communication costs. Instead of having to share the weights that they&#8217;re using, each worker only has to let the central parameter server which random seed they&#8217;re using, what iteration they&#8217;re on, and how well that model did. With just the random seed and the iteration, the central parameter server can recreate the weights the worker used.</p>
</div>
<div class="paragraph">
<p>While on a single machine it might be slower than using Deep Q Learning, A3C, or something else, it really shines when used on a cluster. OpenAI in their blog post mentioned they were able to solve complex environments (such as teaching a model of a human to walk!) in just ten minutes with a cluster.</p>
</div>
<div class="paragraph">
<p>Another benefit is that you only have to do a forward pass on the models, there&#8217;s no backpropagation so no need to calculate gradients. That means less math and faster evaluation of a models performance.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_when_not_to_use_them">When Not to Use Them</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Evolution strategies are not without their drawbacks however, while they can scale, they struggle with larger networks. Reinforcement learning networks tend to be relatively simple, usually only consisting of two hidden layers with less than 512 nodes per layer, and thus it makes sense for evolution strategies.</p>
</div>
<div class="paragraph">
<p>But complex networks such as image recognition networks have millions of parameters to adjust, making backpropagation a far more feasible solution.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_conclusion">Conclusion</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Evolutionary strategies have been on the wayside for years due to backpropagations success, however that&#8217;s not to say they don&#8217;t have their merits and applications. OpenAI has been able to show that they&#8217;re not only feasible, but far more effective than traditional backpropagation methods for reinforcement learning.</p>
</div>
<div class="paragraph">
<p>You can check out my gist linked at the start of this article if you want to try it out for yourself, while it only works on a single machine negating the major benefit to using evolution strategies, it serves as a nice proof of concept</p>
</div>
<div class="paragraph">
<p>-Nick</p>
</div>
</div>
</div>
        </section>

    </article>

</main>
    <footer class="animated fadeIn" id="footer">
        <section class="colophon">
          <section class="copyright">Copyright &copy; <span itemprop="copyrightHolder">Nick Samoray&#x27;s Blog</span>. <span rel="license">All Rights Reserved</span>.</section>
          <section class="poweredby">Published with <a class="icon-ghost" href="http://hubpress.io">HubPress</a></section>
        </section>
        <section class="bottom">
          <section class="attribution">
            <a href="http://github.com/Reedyn/Saga">Built with <i class="fa fa-heart"></i> and Free and Open-Source Software</a>.
          </section>
        </section>
    </footer>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js?v="></script> <script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.9.0/moment-with-locales.min.js?v="></script> <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.10.0/highlight.min.js?v="></script> 
      <script type="text/javascript">
        jQuery( document ).ready(function() {
          // change date with ago
          jQuery('ago.ago').each(function(){
            var element = jQuery(this).parent();
            element.html( moment(element.text()).fromNow());
          });
        });

        hljs.initHighlightingOnLoad();
      </script>
       
    <script src='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>
    <script src="//nicksam112.github.io/themes/saga/assets/js/scripts.js?v=1502307335087"></script>
    
</body>
</html>
