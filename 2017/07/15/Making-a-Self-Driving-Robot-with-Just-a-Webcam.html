<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>Making a Self Driving Robot with Just a Webcam</title>
    <meta name="description" content="" />
    <link href="//fonts.googleapis.com/css?family=Noto+Sans:300,400,700" rel="stylesheet" type="text/css">
    <link href="//fonts.googleapis.com/css?family=Noto+Serif:400,700,400italic" rel="stylesheet" type="text/css">
    <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
    <link href="//nicksam112.github.io/themes/saga/assets/css/style.css?v=1502307335107" rel="stylesheet" type="text/css">
    <link href="//nicksam112.github.io/themes/saga/assets/css/animate.min.css?v=1502307335107" rel="stylesheet" type="text/css">
    <link href="https://nicksam112.github.io/favicon.ico" rel="shortcut icon">
    <link rel="canonical" href="https://nicksam112.github.io/2017/07/15/Making-a-Self-Driving-Robot-with-Just-a-Webcam.html" />
    <meta name="referrer" content="origin" />
    
    <meta property="og:site_name" content="Nick Samoray&#x27;s Blog" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Making a Self Driving Robot with Just a Webcam" />
    <meta property="og:description" content="Before we start, here&amp;#8217;s a gyf of it in action Background For my internship at Booz Allen Hamilton, one of my tasks was to find a way to navigate a robot with a sensor package mounted on it throughout a building. The problem? I couldn&amp;#8217;t modify" />
    <meta property="og:url" content="https://nicksam112.github.io/2017/07/15/Making-a-Self-Driving-Robot-with-Just-a-Webcam.html" />
    <meta property="og:image" content="http://imgur.com/PXgSv8v.jpg" />
    <meta property="article:published_time" content="2017-07-15T00:00:00.000Z" />
    <meta property="article:tag" content="Deep Learning" />
    <meta property="article:tag" content="Autonomous Navigation" />
    <meta property="article:tag" content="Keras" />
    
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Making a Self Driving Robot with Just a Webcam" />
    <meta name="twitter:description" content="Before we start, here&amp;#8217;s a gyf of it in action Background For my internship at Booz Allen Hamilton, one of my tasks was to find a way to navigate a robot with a sensor package mounted on it throughout a building. The problem? I couldn&amp;#8217;t modify" />
    <meta name="twitter:url" content="https://nicksam112.github.io/2017/07/15/Making-a-Self-Driving-Robot-with-Just-a-Webcam.html" />
    <meta name="twitter:image:src" content="http://imgur.com/PXgSv8v.jpg" />
    
    <script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "Article",
    "publisher": "Nick Samoray's Blog",
    "author": {
        "@type": "Person",
        "name": "Nick Samoray",
        "image": "https://avatars3.githubusercontent.com/u/11080378?v=4",
        "url": "https://nicksam112.github.io/author/nicksam112/",
        "description": "I don&#x27;t put much here besides the occasional bad idea"
    },
    "headline": "Making a Self Driving Robot with Just a Webcam",
    "url": "https://nicksam112.github.io/2017/07/15/Making-a-Self-Driving-Robot-with-Just-a-Webcam.html",
    "datePublished": "2017-07-15T00:00:00.000Z",
    "image": "http://imgur.com/PXgSv8v.jpg",
    "keywords": "Deep Learning, Autonomous Navigation, Keras",
    "description": "Before we start, here&amp;#8217;s a gyf of it in action Background For my internship at Booz Allen Hamilton, one of my tasks was to find a way to navigate a robot with a sensor package mounted on it throughout a building. The problem? I couldn&amp;#8217;t modify"
}
    </script>

    <meta name="generator" content="HubPress" />
    <link rel="alternate" type="application/rss+xml" title="Nick Samoray&#x27;s Blog" href="https://nicksam112.github.io/rss/" />
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.10.0/styles/atom-one-dark.min.css">
</head>
<body class="post-template tag-Deep-Learning tag-Autonomous-Navigation tag-Keras">
    <header id="header" class="animated fadeIn" style="background-image: url(http://imgur.com/PXgSv8v.jpg)">
    <div class="header-background">
    <section class="blog-content">
        <a id="site-url" class="blog-title" href="https://nicksam112.github.io">Nick Samoray&#x27;s Blog</a>
        <span class="blog-description">Posts and Projects</span>
        <nav class="links fadeIn animated">
            <ul>
                <li class="rss"><a title="RSS Feed" href="/rss/"><i class="fa fa-fw fa-rss-square"></i></a></li>
        
            </ul>
        </nav>
    </section>
    <section class="header-content">
        <h1 class="post-title animated fadeInUp">Making a Self Driving Robot with Just a Webcam</h1>
        <span class="post-data"><span class="date animated fadeInUp"><i class="fa fa-clock-o"></i> <time class="timesince date" data-timesince="1500094800" datetime="2017-07-15T00:00" title="15 July 2017">a month ago</time></span>
            <span class="tags animated fadeInUp"><i class="fa fa-tags"></i> <a href="https://nicksam112.github.io/tag/Deep-Learning/">Deep Learning</a>, <a href="https://nicksam112.github.io/tag/Autonomous-Navigation/">Autonomous Navigation</a>, <a href="https://nicksam112.github.io/tag/Keras/">Keras</a></span>
            <span class="author animated fadeInUp"><i class="fa fa-user"></i> <a href="https://nicksam112.github.io/author/nicksam112/">Nick Samoray</a></span></span>
    </section>
    </div>
</header>
<main id="main" class="content">
    <article itemtype="http://schema.org/BlogPosting" class="animated fadeIn content post post tag-Deep-Learning tag-Autonomous-Navigation tag-Keras">
        <section class="post-content">
            <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Before we start, <a href="https://gfycat.com/DecentAbsoluteFlies">here&#8217;s a gyf of it in action</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_background">Background</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For my internship at Booz Allen Hamilton, one of my tasks was to find a way to navigate a robot with a sensor package mounted on it throughout a building. The problem? I couldn&#8217;t modify the existing building infrastructure, so no guiding magnets or painting lines, and it had to be done cheaply.</p>
</div>
<div class="paragraph">
<p>With a budget of only a few thousand for the entire project, and the interior robot being only a third of the overall solution, there wasn&#8217;t a lot of wiggle room.</p>
</div>
<div class="paragraph">
<p>The solution I came up with? A roomba, a rasberry pi, and deep learning.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_hardware_solution">The Hardware Solution</h2>
<div class="sectionbody">
<div class="paragraph">
<p>I settled on a roomba due to a few reasons, it was cheap (about 200 bucks), it was large enough to mount plenty of sensors, and it was easy enough to control with a raspberry pi.</p>
</div>
<div class="paragraph">
<p>The shopping list consisted of:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Roomba</p>
</li>
<li>
<p>Serial to USB cable</p>
</li>
<li>
<p>Raspberry Pi</p>
</li>
<li>
<p>Cheapest webcam we could find</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Total cost was about 300 bucks, but now came the question of how to actually make it autonomous. I ultimately decided on a visual input based navigation system. Due to cost, a fancy LIDAR system wasn&#8217;t much of an option, and I wanted to see just how well I could get it to navigate with just a webcam.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_software_solution">The Software Solution</h2>
<div class="sectionbody">
<div class="paragraph">
<p>On the software end I used Keras and decided to treat it as a traditional image classification problem with three different classes, left, right, and forward. However there was an issue of processing power.</p>
</div>
<div class="paragraph">
<p>Initially I wanted to mount the laptop on top of the roomba and use its webcam and processing power. However due to the need to mount all the other sensors on the roomba, that was out of the picture. Thus I needed the model to fit on a raspberry pi and be able to run quickly enough to effectively navigate. I settled on 10 FPS which allowed me to use a model with about 1.5 million parameters in order to navigate.</p>
</div>
<div class="paragraph">
<p>With only 1.5 million parameters, I settled on the following model architecture</p>
</div>
<table class="tableblock frame-all grid-all" style="width: 50%;">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3x94x126</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Input</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3x3x16</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2D Convolution</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3x3x32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2D Convolution</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3x3x64</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2D Convolution</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3x3x128</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2D Convolution</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">512</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dense</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Output</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>This came out to 1.672 million parameters and was able to run at at least 10 FPS on the raspberry pi</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_training">Training</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Training the bot was fairly straight forward, I wrote a python script that would read keyboard input and take a picture every 1/10 of a second which was then saved in the corresponding folder (left, right, forward), and ran it around the office several times. Care was taken to keep it centered in hallways and aiming it towards the next doorway.</p>
</div>
<div class="paragraph">
<p>Next I ran it through the office again, this time picking it up and moving it off center or at odd angles, then guiding it back on to the right track. This was essential for making sure the bot would actually know hwo to react if it ran off course for whatever reason.</p>
</div>
<div class="paragraph">
<p>The model was then trained on an Amazon EC2 p2.xlarge isntance for about 8 hours until its accuracy was hovering around 95%.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_result">Result</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The roomba was able to (somewhat) successfully navigate through portions of the office. It was able to look for doorways, stay centered in hallways, however issues popped up in certain areas. If a doorway wasn&#8217;t visible, or there was a lot of visual noise (people walking around, etc), the bot could struggle. However as an initial first step I think it&#8217;s encouraging</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_future_directions">Future Directions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Two interesting directions come to mind when considering the project, imitation learning and reinforcement learning.</p>
</div>
<div class="paragraph">
<p>A lot of work has recently come out in regards to imitation learning for robots using deep learning, teams like OpenAI have been able to teach <a href="https://blog.openai.com/robots-that-learn/">robots how to perform a task just by observing a human doing it</a>. Modifying this to instead teach a robot to navigate through a certain building after walking it through it once could be feasible and would be incredibly interesting</p>
</div>
<div class="paragraph">
<p>Reinforcement learning is another direction that comes to mind, with the front bumper the roomba is able to detect when it bumps into an object. If this could be tied to a negative reward, and have going into a new room being tagged as a positive reward, it might be possible to have it teach itself how to get around a building. The positive rewards could be determined by RFID tags on the ground and a scanner on the bot, the more it hits, and the faster it hits them, the better the reward. That however requries modifying the existing infrastructure, but perhaps for a future project.</p>
</div>
<div class="paragraph">
<p>-Nick</p>
</div>
</div>
</div>
        </section>

    </article>

</main>
    <footer class="animated fadeIn" id="footer">
        <section class="colophon">
          <section class="copyright">Copyright &copy; <span itemprop="copyrightHolder">Nick Samoray&#x27;s Blog</span>. <span rel="license">All Rights Reserved</span>.</section>
          <section class="poweredby">Published with <a class="icon-ghost" href="http://hubpress.io">HubPress</a></section>
        </section>
        <section class="bottom">
          <section class="attribution">
            <a href="http://github.com/Reedyn/Saga">Built with <i class="fa fa-heart"></i> and Free and Open-Source Software</a>.
          </section>
        </section>
    </footer>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js?v="></script> <script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.9.0/moment-with-locales.min.js?v="></script> <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.10.0/highlight.min.js?v="></script> 
      <script type="text/javascript">
        jQuery( document ).ready(function() {
          // change date with ago
          jQuery('ago.ago').each(function(){
            var element = jQuery(this).parent();
            element.html( moment(element.text()).fromNow());
          });
        });

        hljs.initHighlightingOnLoad();
      </script>
       
    <script src='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>
    <script src="//nicksam112.github.io/themes/saga/assets/js/scripts.js?v=1502307335107"></script>
    
</body>
</html>
